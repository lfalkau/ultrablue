<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="949" height="1513"><desc>participantgroup%20%23lightblue%20**Server%20(attester)**%0Aparticipant%20TPM%0Aparticipant%20Server%0Aend%0A%0Aparticipant%20Client%0A%0Agroup%20%23green%20Enrollment%20specific%0AServer%3C-%3ETPM%3A%20Generate%20encryption%20key%0AServer%20-%23gray%3E%3E%20Client%3A%20%3Ccolor%20%23gray%3EConnection%2FEncryption%20materials%0AClient-%3EClient%3A%20Generate%20random%20UUID%0Aend%0A%0AClient-%230000ff%3A1%3EServer%3A%20UUID%0A%0AServer%3C-%3ETPM%3A%20Generate%20auth%20nonce%0AServer-%230000ff%3A1%3EClient%3A%20%3Ccolor%3A%23cd7f32%3EAuth%20nonce%3C%2Fcolor%3E%0AServer%3C%230000ff%3A1-Client%3A%20%3Ccolor%3A%23cd7f32%3ETweaked%20auth%20nonce%3C%2Fcolor%3E%0AServer-%3EServer%3A%20Verify%20tweaked%20nonce%0A%0Agroup%20%23green%20Enrollment%20specific%0AServer%3C-%3ETPM%3A%20Generate%20EK%20and%20fetch%20EKpub%2FEKcert%0AServer-%230000ff%3A1%3EClient%3A%20%3Ccolor%3A%23cd7f32%3EEKpub%20%2B%20EKcert%20%2B%20flags%3C%2Fcolor%3E%0Aend%0A%0AServer%3C-%3ETPM%3A%20Generate%20AK%20and%20fetch%20AKname%0AServer-%230000ff%3A1%3EClient%3A%20%3Ccolor%3A%23cd7f32%3EAKname%0AClient-%3EClient%3A%20Generate%20secret%5CnMakeCredential(EK%2C%20AK%2C%20secret)%0A%0AClient-%230000ff%3A1%3EServer%3A%20%3Ccolor%3A%23cd7f32%3EMakeCredential%20challenge%0AServer%3C-%3ETPM%3A%20ActivateCredential(challenge)%0AServer-%230000ff%3A1%3EClient%3A%20%3Ccolor%3A%23cd7f32%3EChallenge%20response%0AClient-%3EClient%3A%20Validate%20challenge%20response%5CnGenerate%20anti-replay%20nonce%0A%0AClient-%230000ff%3A1%3EServer%3A%20%3Ccolor%3A%23cd7f32%3EAnti-replay%20nonce%0AServer%3C-%3ETPM%3A%20GenerateQuote(AK%2C%20anti-replay%20nonce)%5Cnand%20fetch%20quote%20%2B%20event%20log%0AServer-%230000ff%3A1%3EClient%3A%20%3Ccolor%3A%23cd7f32%3Equote%20%2B%20event%20log%0AClient-%3EClient%3A%20Validate%20quote%20signature%5CnValidate%20quote%20anti-replay%20nonce%5CnApply%20PCR%20policy%5CnReplay%20event%20log%20(optional)%0A%0AClient-%230000ff%3A1%3EServer%3A%20%3Ccolor%3A%23cd7f32%3EAttestation%20response%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="949" height="1513"/></g><g><g><path fill="lightblue" stroke="black" paint-order="fill stroke markers" d=" M 32.45045063494189 9.556093930499998 L 426.69358207943395 9.556093930499998 L 426.69358207943395 1505.615688161 L 32.45045063494189 1505.615688161 L 32.45045063494189 9.556093930499998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="169.51368200660198" y="32.4253785505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server (attester)</text></g><rect fill="rgb(204,230,204)" stroke="none" x="16.335203299999996" y="125.291009311" width="873.3667936294339" height="202.55652092000003"/><rect fill="rgb(204,230,204)" stroke="none" x="16.335203299999996" y="602.2789456710001" width="737.2754668133532" height="135.58218738999994"/></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 73.50841485 92.620602711 L 73.50841485 1505.615688161" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 378.7189508798177 92.620602711 L 378.7189508798177 1505.615688161" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 696.4374585633532 92.620602711 L 696.4374585633532 1505.615688161" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 40.61805228494189 48.51555380100001 L 106.3987774150581 48.51555380100001 L 106.3987774150581 92.620602711 L 40.61805228494189 92.620602711 L 40.61805228494189 48.51555380100001 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="58.34174786544189" y="76.28539941099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TPM</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 338.9119213302015 48.51555380100001 L 418.52598042943396 48.51555380100001 L 418.52598042943396 92.620602711 L 338.9119213302015 92.620602711 L 338.9119213302015 48.51555380100001 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="356.6356169107015" y="76.28539941099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 658.9804293952067 48.51555380100001 L 733.8944877314997 48.51555380100001 L 733.8944877314997 92.620602711 L 658.9804293952067 92.620602711 L 658.9804293952067 48.51555380100001 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="676.7041249757067" y="76.28539941099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g></g><g><g><g><rect fill="rgb(204,230,204)" stroke="none" x="139.28007107108076" y="169.396058221" width="173.66722358765625" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="141.73035156608074" y="184.09774119099998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate encryption key</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 365.2696334961511 190.631822511 L 86.95773223366666 190.631822511" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(73.50841485,190.631822511) translate(-73.50841485,-190.631822511)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.12108426666666 183.82548780266666 L 73.50841485 190.631822511 L 87.12108426666666 197.43815721933333 Z"/><g transform="translate(378.7189508798177,190.631822511) translate(-378.7189508798177,-190.631822511)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 365.10628146315105 183.82548780266666 L 378.7189508798177 190.631822511 L 365.10628146315105 197.43815721933333 Z"/></g></g></g><g><g><rect fill="rgb(204,230,204)" stroke="none" x="422.0362570512925" y="215.134627461" width="231.08389534058594" height="21.23576429"/></g><text fill="gray" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="424.48653754629254" y="229.836310431" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Connection/Encryption materials</text></g><g><path fill="none" stroke="gray" paint-order="fill stroke markers" d=" M 378.7189508798177 236.370391751 L 694.3955581508532 236.370391751" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(696.4374585633532,236.370391751) translate(-696.4374585633532,-236.370391751)"><path fill="none" stroke="gray" paint-order="fill stroke markers" d=" M 682.4422141802992 230.12699426537657 L 694.9071586978037 236.370391751 L 682.4422141802992 242.61378923662343" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><g><rect fill="rgb(204,230,204)" stroke="none" x="715.7674491350199" y="260.87319670100004" width="168.21722663941406" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="718.2177296300199" y="275.574879671" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate random UUID</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 696.4374585633532 282.108960991 L 761.7782717633531 282.108960991 L 761.7782717633531 303.344725281 L 709.8867759470198 303.344725281" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(696.4374585633532,303.344725281) translate(-696.4374585633532,-303.344725281)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 710.0501279800199 296.5383905726667 L 696.4374585633532 303.344725281 L 710.0501279800199 310.15105998933336 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="519.003203958646" y="367.05201815099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UUID</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 696.4374585633532 373.586099471 L 392.1682682634844 373.586099471" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(378.7189508798177,373.586099471) translate(-378.7189508798177,-373.586099471)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 392.3316202964844 366.7797647626667 L 378.7189508798177 373.586099471 L 392.3316202964844 380.39243417933335 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="153.372014163737" y="412.790587391" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate auth nonce</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 365.2696334961511 419.324668711 L 86.95773223366666 419.324668711" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(73.50841485,419.324668711) translate(-73.50841485,-419.324668711)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.12108426666666 412.5183340026667 L 73.50841485 419.324668711 L 87.12108426666666 426.13100341933335 Z"/><g transform="translate(378.7189508798177,419.324668711) translate(-378.7189508798177,-419.324668711)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 365.10628146315105 412.5183340026667 L 378.7189508798177 419.324668711 L 365.10628146315105 426.13100341933335 Z"/></g></g></g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="498.094871133939" y="458.529156631" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Auth nonce</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 378.7189508798177 465.063237951 L 682.9881411796865 465.063237951" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(696.4374585633532,465.063237951) translate(-696.4374585633532,-465.063237951)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 682.8247891466865 458.2569032426667 L 696.4374585633532 465.063237951 L 682.8247891466865 471.86957265933336 Z"/></g></g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.2532077733433" y="504.267725871" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Tweaked auth nonce</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 696.4374585633532 510.801807191 L 392.1682682634844 510.801807191" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(378.7189508798177,510.801807191) translate(-378.7189508798177,-510.801807191)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 392.3316202964844 503.9954724826667 L 378.7189508798177 510.801807191 L 392.3316202964844 517.6081418993333 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="400.4992219464844" y="550.006295111" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Verify tweaked nonce</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 378.7189508798177 556.540376431 L 444.05976407981774 556.540376431 L 444.05976407981774 577.776140721 L 392.1682682634844 577.776140721" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(378.7189508798177,577.776140721) translate(-378.7189508798177,-577.776140721)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 392.3316202964844 570.9698060126667 L 378.7189508798177 577.776140721 L 392.3316202964844 584.5824754293334 Z"/></g></g><g><g><rect fill="rgb(204,230,204)" stroke="none" x="98.11339931815105" y="646.383994581" width="256.0005670935156" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="100.56367981315105" y="661.085677551" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate EK and fetch EKpub/EKcert</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 365.2696334961511 667.619758871 L 86.95773223366666 667.619758871" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(73.50841485,667.619758871) translate(-73.50841485,-667.619758871)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.12108426666666 660.8134241626667 L 73.50841485 667.619758871 L 87.12108426666666 674.4260935793334 Z"/><g transform="translate(378.7189508798177,667.619758871) translate(-378.7189508798177,-667.619758871)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 365.10628146315105 660.8134241626667 L 378.7189508798177 667.619758871 L 365.10628146315105 674.4260935793334 Z"/></g></g></g><g><g><rect fill="rgb(204,230,204)" stroke="none" x="458.4112570512925" y="692.122563821" width="158.33389534058594" height="21.23576429"/></g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="460.86153754629254" y="706.824246791" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">EKpub + EKcert + flags</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 378.7189508798177 713.358328111 L 682.9881411796865 713.358328111" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(696.4374585633532,713.358328111) translate(-696.4374585633532,-713.358328111)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 682.8247891466865 706.5519934026667 L 696.4374585633532 713.358328111 L 682.8247891466865 720.1646628193333 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="117.9220172154948" y="777.0656209809999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate AK and fetch AKname</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 365.2696334961511 783.599702301 L 86.95773223366666 783.599702301" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(73.50841485,783.599702301) translate(-73.50841485,-783.599702301)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.12108426666666 776.7933675926666 L 73.50841485 783.599702301 L 87.12108426666666 790.4060370093333 Z"/><g transform="translate(378.7189508798177,783.599702301) translate(-378.7189508798177,-783.599702301)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 365.10628146315105 776.7933675926666 L 378.7189508798177 783.599702301 L 365.10628146315105 790.4060370093333 Z"/></g></g></g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="508.7032047215855" y="822.8041902209999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AKname</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 378.7189508798177 829.3382715409999 L 682.9881411796865 829.3382715409999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(696.4374585633532,829.3382715409999) translate(-696.4374585633532,-829.3382715409999)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 682.8247891466865 822.5319368326666 L 696.4374585633532 829.3382715409999 L 682.8247891466865 836.1446062493333 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="718.2177296300199" y="868.5427594609998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate secret</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="718.2177296300199" y="884.8779627609998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MakeCredential(EK, AK, secret)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 696.4374585633532 891.4120440809999 L 761.7782717633531 891.4120440809999 L 761.7782717633531 912.6478083709999 L 709.8867759470198 912.6478083709999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(696.4374585633532,912.6478083709999) translate(-696.4374585633532,-912.6478083709999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 710.0501279800199 905.8414736626665 L 696.4374585633532 912.6478083709999 L 710.0501279800199 919.4541430793332 Z"/></g></g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="448.21153602041363" y="951.8522962909998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MakeCredential challenge</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 696.4374585633532 958.3863776109998 L 392.1682682634844 958.3863776109998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(378.7189508798177,958.3863776109998) translate(-378.7189508798177,-958.3863776109998)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 392.3316202964844 951.5800429026665 L 378.7189508798177 958.3863776109998 L 392.3316202964844 965.1927123193332 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="125.68867981315105" y="997.5908655309997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ActivateCredential(challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 365.2696334961511 1004.1249468509998 L 86.95773223366666 1004.1249468509998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(73.50841485,1004.1249468509998) translate(-73.50841485,-1004.1249468509998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.12108426666666 997.3186121426664 L 73.50841485 1004.1249468509998 L 87.12108426666666 1010.9312815593331 Z"/><g transform="translate(378.7189508798177,1004.1249468509998) translate(-378.7189508798177,-1004.1249468509998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 365.10628146315105 997.3186121426664 L 378.7189508798177 1004.1249468509998 L 365.10628146315105 1010.9312815593331 Z"/></g></g></g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="469.6282077733433" y="1043.329434771" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Challenge response</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 378.7189508798177 1049.8635160909998 L 682.9881411796865 1049.8635160909998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(696.4374585633532,1049.8635160909998) translate(-696.4374585633532,-1049.8635160909998)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 682.8247891466865 1043.0571813826666 L 696.4374585633532 1049.8635160909998 L 682.8247891466865 1056.669850799333 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="718.2177296300199" y="1089.068004011" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate challenge response</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="718.2177296300199" y="1105.4032073110002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate anti-replay nonce</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 696.4374585633532 1111.937288631 L 761.7782717633531 1111.937288631 L 761.7782717633531 1133.173052921 L 709.8867759470198 1133.173052921" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(696.4374585633532,1133.173052921) translate(-696.4374585633532,-1133.173052921)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 710.0501279800199 1126.3667182126667 L 696.4374585633532 1133.173052921 L 710.0501279800199 1139.9793876293331 Z"/></g></g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="477.1032062474644" y="1172.3775408410002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Anti-replay nonce</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 696.4374585633532 1178.911622161 L 392.1682682634844 1178.911622161" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(378.7189508798177,1178.911622161) translate(-378.7189508798177,-1178.911622161)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 392.3316202964844 1172.1052874526667 L 378.7189508798177 1178.911622161 L 392.3316202964844 1185.7179568693332 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="95.28868591666668" y="1218.116110081" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GenerateQuote(AK, anti-replay nonce)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="95.28868591666668" y="1234.451313381" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and fetch quote + event log</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 365.2696334961511 1240.985394701 L 86.95773223366666 1240.985394701" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(73.50841485,1240.985394701) translate(-73.50841485,-1240.985394701)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.12108426666666 1234.1790599926667 L 73.50841485 1240.985394701 L 87.12108426666666 1247.7917294093331 Z"/><g transform="translate(378.7189508798177,1240.985394701) translate(-378.7189508798177,-1240.985394701)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 365.10628146315105 1234.1790599926667 L 378.7189508798177 1240.985394701 L 365.10628146315105 1247.7917294093331 Z"/></g></g></g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="477.51153907217144" y="1280.1898826210002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">quote + event log</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 378.7189508798177 1286.723963941 L 682.9881411796865 1286.723963941" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(696.4374585633532,1286.723963941) translate(-696.4374585633532,-1286.723963941)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 682.8247891466865 1279.9176292326667 L 696.4374585633532 1286.723963941 L 682.8247891466865 1293.5302986493332 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="718.2177296300199" y="1325.9284518610002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate quote signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="718.2177296300199" y="1342.2636551610003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate quote anti-replay nonce</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="718.2177296300199" y="1358.5988584610004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Apply PCR policy</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="718.2177296300199" y="1374.9340617610005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Replay event log (optional)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 696.4374585633532 1381.468143081 L 761.7782717633531 1381.468143081 L 761.7782717633531 1402.703907371 L 709.8867759470198 1402.703907371" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(696.4374585633532,1402.703907371) translate(-696.4374585633532,-1402.703907371)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 710.0501279800199 1395.8975726626668 L 696.4374585633532 1402.703907371 L 710.0501279800199 1409.5102420793332 Z"/></g></g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.0782047215855" y="1441.9083952910003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Attestation response</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 696.4374585633532 1448.442476611 L 392.1682682634844 1448.442476611" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(378.7189508798177,1448.442476611) translate(-378.7189508798177,-1448.442476611)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 392.3316202964844 1441.6361419026669 L 378.7189508798177 1448.442476611 L 392.3316202964844 1455.2488113193333 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 16.335203299999996 125.291009311 L 889.7019969294339 125.291009311 L 889.7019969294339 327.847530231 L 16.335203299999996 327.847530231 L 16.335203299999996 125.291009311 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="green" stroke="black" paint-order="fill stroke markers" d=" M 16.335203299999996 125.291009311 L 16.335203299999996 144.893253271 L 161.1056083741211 144.893253271 L 170.9067303541211 135.092131291 L 170.9067303541211 125.291009311 L 16.335203299999996 125.291009311" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="32.67040659999999" y="138.35917195099998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Enrollment specific</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 16.335203299999996 602.2789456710001 L 753.6106701133532 602.2789456710001 L 753.6106701133532 737.861133061 L 16.335203299999996 737.861133061 L 16.335203299999996 602.2789456710001 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="green" stroke="black" paint-order="fill stroke markers" d=" M 16.335203299999996 602.2789456710001 L 16.335203299999996 621.8811896310001 L 161.1056083741211 621.8811896310001 L 170.9067303541211 612.080067651 L 170.9067303541211 602.2789456710001 L 16.335203299999996 602.2789456710001" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="32.67040659999999" y="615.347108311" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Enrollment specific</text></g></g><g/><g/><g/></g></svg>