<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1000" height="656"><desc>participantgroup%20%23lightblue%20**Server%20(attester)**%0Aparticipant%20TPM%0Aparticipant%20Server%0Aend%0A%0Aparticipant%20Client%0A%0AServer-%230000ff%3A1%3EClient%3A%20%3Ccolor%3A%23cd7f32%3EAKname%0AClient-%3EClient%3A%20Generate%20secret%5CnMakeCredential(EK%2C%20AK%2C%20secret)%0A%0AClient-%230000ff%3A1%3EServer%3A%20%20%20%20%20%20%20%20%3Ccolor%3A%23cd7f32%3EMakeCredential%20challenge%0AServer%3C-%3ETPM%3A%20ActivateCredential(challenge)%0A%0AServer%3C-%3ETPM%3A%20GenerateQuote(AK%2C%20decrypted%20challenge)%5Cnand%20fetch%20quote%20%2B%20event%20log%0AServer-%230000ff%3A1%3EClient%3A%20%3Ccolor%3A%23cd7f32%3Equote%20%2B%20event%20log%0AClient-%3EClient%3A%20Validate%20quote%20signature%5CnValidate%20MakeCredential%20challenge%20in%20quote%5CnApply%20PCR%20policy%5CnReplay%20event%20log%20(optional)%0A%0AClient-%230000ff%3A1%3EServer%3A%20%3Ccolor%3A%23cd7f32%3EAttestation%20response%0A%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1000" height="656"/></g><g><g><path fill="lightblue" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000003 9.556093930499998 L 422.44405828980456 9.556093930499998 L 422.44405828980456 648.017514911 L 8.167601650000003 648.017514911 L 8.167601650000003 9.556093930499998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="155.24749561931634" y="32.4253785505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server (attester)</text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 49.22556586505811 92.620602711 L 49.22556586505811 648.017514911" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 374.46942709018833 92.620602711 L 374.46942709018833 648.017514911" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 671.4546050007746 92.620602711 L 671.4546050007746 648.017514911" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 16.335203300000003 48.51555380100001 L 82.11592843011621 48.51555380100001 L 82.11592843011621 92.620602711 L 16.335203300000003 92.620602711 L 16.335203300000003 48.51555380100001 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="34.0588988805" y="76.28539941099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TPM</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 334.6623975405721 48.51555380100001 L 414.27645663980456 48.51555380100001 L 414.27645663980456 92.620602711 L 334.6623975405721 92.620602711 L 334.6623975405721 48.51555380100001 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="352.3860931210721" y="76.28539941099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 633.9975758326281 48.51555380100001 L 708.9116341689211 48.51555380100001 L 708.9116341689211 92.620602711 L 633.9975758326281 92.620602711 L 633.9975758326281 48.51555380100001 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="651.7212714131281" y="76.28539941099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g></g><g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="494.0870160454815" y="139.99269228100002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AKname</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 374.46942709018833 146.526773601 L 658.0052876171079 146.526773601" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(671.4546050007746,146.526773601) translate(-671.4546050007746,-146.526773601)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 657.8419355841079 139.72043889266666 L 671.4546050007746 146.526773601 L 657.8419355841079 153.33310830933334 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.2348760674413" y="185.731261521" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate secret</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.2348760674413" y="202.06646482099998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MakeCredential(EK, AK, secret)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 671.4546050007746 208.60054614100002 L 736.7954182007745 208.60054614100002 L 736.7954182007745 229.83631043100002 L 684.9039223844412 229.83631043100002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(671.4546050007746,229.83631043100002) translate(-671.4546050007746,-229.83631043100002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 685.0672744174412 223.02997572266668 L 671.4546050007746 229.83631043100002 L 685.0672744174412 236.64264513933335 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="420.23701375666315" y="269.04079835100003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       </text><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.9536809319561" y="269.04079835100003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MakeCredential challenge</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 671.4546050007746 275.574879671 L 387.918744473855 275.574879671" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(374.46942709018833,275.574879671) translate(-374.46942709018833,-275.574879671)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 388.082096506855 268.7685449626667 L 374.46942709018833 275.574879671 L 388.082096506855 282.38121437933336 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="111.42249342586541" y="314.779367591" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ActivateCredential(challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 361.0201097065217 321.313448911 L 62.674883248724775 321.313448911" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(49.22556586505811,321.313448911) translate(-49.22556586505811,-321.313448911)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 62.83823528172478 314.5071142026667 L 49.22556586505811 321.313448911 L 62.83823528172478 328.11978361933336 Z"/><g transform="translate(374.46942709018833,321.313448911) translate(-374.46942709018833,-321.313448911)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 360.85675767352166 314.5071142026667 L 374.46942709018833 321.313448911 L 360.85675767352166 328.11978361933336 Z"/></g></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="71.00583693172479" y="360.517936831" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GenerateQuote(AK, decrypted challenge)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="71.00583693172479" y="376.853140131" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and fetch quote + event log</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 361.0201097065217 383.387221451 L 62.674883248724775 383.387221451" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(49.22556586505811,383.387221451) translate(-49.22556586505811,-383.387221451)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 62.83823528172478 376.5808867426667 L 49.22556586505811 383.387221451 L 62.83823528172478 390.19355615933335 Z"/><g transform="translate(374.46942709018833,383.387221451) translate(-374.46942709018833,-383.387221451)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 360.85675767352166 376.5808867426667 L 374.46942709018833 383.387221451 L 360.85675767352166 390.19355615933335 Z"/></g></g></g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="462.89535039606744" y="422.591709371" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">quote + event log</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 374.46942709018833 429.125790691 L 658.0052876171079 429.125790691" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(671.4546050007746,429.125790691) translate(-671.4546050007746,-429.125790691)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 657.8419355841079 422.3194559826667 L 671.4546050007746 429.125790691 L 657.8419355841079 435.93212539933336 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.2348760674413" y="468.33027861100004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate quote signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.2348760674413" y="484.66548191100003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate MakeCredential challenge in quote</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.2348760674413" y="501.000685211" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Apply PCR policy</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.2348760674413" y="517.335888511" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Replay event log (optional)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 671.4546050007746 523.869969831 L 736.7954182007745 523.869969831 L 736.7954182007745 545.1057341210001 L 684.9039223844412 545.1057341210001" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(671.4546050007746,545.1057341210001) translate(-671.4546050007746,-545.1057341210001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 685.0672744174412 538.2993994126667 L 671.4546050007746 545.1057341210001 L 685.0672744174412 551.9120688293334 Z"/></g></g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="451.4620160454815" y="584.310222041" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Attestation response</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 671.4546050007746 590.844303361 L 387.918744473855 590.844303361" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(374.46942709018833,590.844303361) translate(-374.46942709018833,-590.844303361)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 388.082096506855 584.0379686526667 L 374.46942709018833 590.844303361 L 388.082096506855 597.6506380693334 Z"/></g></g></g><g/><g/><g/></g></svg>