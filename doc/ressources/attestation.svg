<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="857" height="548"><desc>participantgroup%20%23lightblue%20**Server%20(attester)**%0Aparticipant%20TPM%0Aparticipant%20Server%0Aend%0A%0Aparticipant%20Client%0A%0AClient-%3EClient%3A%20Generate%20anti-replay%20nonce%0A%0AClient-%230000ff%3A1%3EServer%3A%20%3Ccolor%3A%23cd7f32%3EAnti-replay%20nonce%0AServer%3C-%3ETPM%3A%20GenerateQuote(AK%2C%20anti-replay%20nonce)%5Cnand%20fetch%20quote%20%2B%20event%20log%0AServer-%230000ff%3A1%3EClient%3A%20%3Ccolor%3A%23cd7f32%3Equote%20%2B%20event%20log%0AClient-%3EClient%3A%20Validate%20quote%20signature%5CnValidate%20quote%20anti-replay%20nonce%5CnApply%20PCR%20policy%5CnReplay%20event%20log%20(optional)%0A%0AClient-%230000ff%3A1%3EServer%3A%20%20%20%20%20%3Ccolor%3A%23cd7f32%3EAttestation%20response%0A%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="857" height="548"/></g><g><g><path fill="lightblue" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000003 9.556093930499998 L 402.41073309449206 9.556093930499998 L 402.41073309449206 540.205173131 L 8.167601650000003 540.205173131 L 8.167601650000003 9.556093930499998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="145.2308330216601" y="32.4253785505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server (attester)</text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 49.22556586505811 92.620602711 L 49.22556586505811 540.205173131" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 354.43610189487583 92.620602711 L 354.43610189487583 540.205173131" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 604.2379416401789 92.620602711 L 604.2379416401789 540.205173131" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 16.335203300000003 48.51555380100001 L 82.11592843011621 48.51555380100001 L 82.11592843011621 92.620602711 L 16.335203300000003 92.620602711 L 16.335203300000003 48.51555380100001 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="34.0588988805" y="76.28539941099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TPM</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 314.6290723452596 48.51555380100001 L 394.24313144449206 48.51555380100001 L 394.24313144449206 92.620602711 L 314.6290723452596 92.620602711 L 314.6290723452596 48.51555380100001 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.3527679257596" y="76.28539941099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 566.7809124720324 48.51555380100001 L 641.6949708083254 48.51555380100001 L 641.6949708083254 92.620602711 L 566.7809124720324 92.620602711 L 566.7809124720324 48.51555380100001 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="584.5046080525324" y="76.28539941099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="626.0182127068456" y="139.992692281" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate anti-replay nonce</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 604.2379416401789 146.526773601 L 669.5787548401788 146.526773601 L 669.5787548401788 167.762537891 L 617.6872590238455 167.762537891" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(604.2379416401789,167.762537891) translate(-604.2379416401789,-167.762537891)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 617.8506110568455 160.95620318266666 L 604.2379416401789 167.762537891 L 617.8506110568455 174.56887259933333 Z"/></g></g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="418.86202329340625" y="206.96702581099998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Anti-replay nonce</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 604.2379416401789 213.501107131 L 367.8854192785425 213.501107131" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(354.43610189487583,213.501107131) translate(-354.43610189487583,-213.501107131)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 368.0487713115425 206.69477242266666 L 354.43610189487583 213.501107131 L 368.0487713115425 220.30744183933334 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="71.00583693172479" y="252.705595051" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GenerateQuote(AK, anti-replay nonce)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="71.00583693172479" y="269.040798351" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and fetch quote + event log</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 340.9867845112092 275.574879671 L 62.674883248724775 275.574879671" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(49.22556586505811,275.574879671) translate(-49.22556586505811,-275.574879671)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 62.83823528172478 268.7685449626667 L 49.22556586505811 275.574879671 L 62.83823528172478 282.38121437933336 Z"/><g transform="translate(354.43610189487583,275.574879671) translate(-354.43610189487583,-275.574879671)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 340.82343247820916 268.7685449626667 L 354.43610189487583 275.574879671 L 340.82343247820916 282.38121437933336 Z"/></g></g></g><g><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="419.2703561181133" y="314.779367591" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">quote + event log</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 354.43610189487583 321.313448911 L 590.7886242565122 321.313448911" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(604.2379416401789,321.313448911) translate(-604.2379416401789,-321.313448911)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 590.6252722235122 314.5071142026667 L 604.2379416401789 321.313448911 L 590.6252722235122 328.11978361933336 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="626.0182127068456" y="360.517936831" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate quote signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="626.0182127068456" y="376.853140131" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate quote anti-replay nonce</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="626.0182127068456" y="393.18834343099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Apply PCR policy</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="626.0182127068456" y="409.52354673099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Replay event log (optional)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 604.2379416401789 416.057628051 L 669.5787548401788 416.057628051 L 669.5787548401788 437.293392341 L 617.6872590238455 437.293392341" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(604.2379416401789,437.293392341) translate(-604.2379416401789,-437.293392341)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 617.8506110568455 430.4870576326667 L 604.2379416401789 437.293392341 L 617.8506110568455 444.09972704933335 Z"/></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="400.2036885613506" y="476.497880261" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    </text><text fill="#cd7f32" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="415.4703549737041" y="476.497880261" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Attestation response</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 604.2379416401789 483.031961581 L 367.8854192785425 483.031961581" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(354.43610189487583,483.031961581) translate(-354.43610189487583,-483.031961581)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 368.0487713115425 476.2256268726667 L 354.43610189487583 483.031961581 L 368.0487713115425 489.83829628933336 Z"/></g></g></g><g/><g/><g/></g></svg>